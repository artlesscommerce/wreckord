
locat module

optional module


user may set their location

1. display map and textbox and button to set location

2. set location

3. get location

4. add link to loggedin.html sidebar, add line to loggedin.html userInfo page


CREATE TABLE `userLocations` (
  `uniqueX` int(11) NOT NULL AUTO_INCREMENT,
  `user` varchar(45) DEFAULT NULL,
  `status1` varchar(45) DEFAULT NULL,
  `addStr` varchar(300) DEFAULT NULL,
  `addLat` varchar(45) DEFAULT NULL,
  `addLng` varchar(45) DEFAULT NULL,
  `dateTime` datetime DEFAULT NULL,
  PRIMARY KEY (`uniqueX`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=latin1;



to install this module on basic modular user log in app :

requirements : none

1.
copy file to :
/app/templates/locat/map.html


2.
# top_one pastepoint 1
from app.mod_locat.locat_one import setLocation
from app.mod_locat.locat_one import getLocation


3.
# top_one pastepoint 2
writeReqs.append( 'newLocation' )


4.
# top_one pastepoint 3
if buttonType == 'newLocation':
	var1 = newLocationButton( args )


5.
# top_one pastepoint 4
s1['location'] = getLocation( varuser )


6.
# top_one pastepoint 5
def newLocationButton( args ):
	username = session['username']
	addStr = args[0]
	addLat = args[1] 
	addLng = args[2] 

	s1 = setLocation( username, addStr, addLat, addLng )

	if s1[0] == "logic ok":
		if s1[1] == "new location set":
			s0 = [ 'logic ok', s1[1], json.dumps( args ), json.dumps( { 'username':username, "okMessage":s1[1] } ) ]
			return s0
		s0 = [ 'logic ok', s1[1], json.dumps( args ), json.dumps( { 'username':username, "errMessage":s1[1] } ) ]

		return s0

	return s1


7.
# __init__ pastepoint 1
from app.mod_locat.locat_one import mod_locat as locat_module


8.
# __init__ pastepoint 2
app.register_blueprint(locat_module)


9.
// loggedin.html pastepoint 1
userpagevar += 'location: '   + jvar['location']


10.
<!-- loggedin.html pastepoint 2 -->
<a href="{{ url_for('locat.mapmess') }}">location</a><br>





